\chapter{Аналитическая часть}
В этом разделе будут проведена формализация задачи, рассмотрен
алгоритм нахождения корреляции Пирсона, приведены возможности для
распараллеливания основного алгоритма.

\section{Корреляция Пирсона}
Корреляция -- статистическая связь двух и более случайных величин \cite{pirson}.
При этом изменение значений одной или нескольких из этих величин сопутствуют систематическому изменению значений другой или других величин.
Сама корреляция не говорит о том, что между случайными величинами есть связь, она лишь говорит, что между ними есть статистическая связь.
В качестве одного из видов корреляции используется корреляция Пирсона.

Коэффициент корреляции Пирсона характеризует существование линейной зависимости между двумя величинами.
Пусть даны две выборки $X^m = (x_1, x_2, ..., x_m)$ и $Y^m = (y_1, y_2, ..., y_m)$. 
Тогда коэффициент корреляции Пирсона рассчитывается по формуле \ref{pirson}:
\begin{equation} \label{pirson}
	r_{xy} = \frac{cov(X, Y)}{\Variance(X) * \Variance(Y)}
\end{equation}
где $\Variance(X)$ -- дисперсия случайной величины, $cov(X, Y)$ -- ковариация случайной величины.

Дисперсия считается по формуле \ref{disperce}:
\begin{equation} \label{disperce}
	\Variance(X) = \sum\limits_{i=1}^M (x_i - \overline{x}^2)
\end{equation}

Ковариация случайных величин X и Y находится по следующему соотношению \ref{covar}:
\begin{equation} \label{covar}
	cov(X, Y) = \mathbf{E}((X - \mathbf{E}(X)) * (Y - \mathbf{E}(Y)))
\end{equation}
где $\mathbf{E}(X)$ -- математическое ожидание случайной величины X.

Коэффициент корреляции Пирсона может принимать значения от -1 до 1.
Если $|r|$ близок к 1, это значит, что между двумя случайными величинами
отслеживается статистическая линейная связь.

По условию задачи нужно найти два признака с максимальной корреляцией, поэтому
учитываться будет только модуль корреляции.

Чтобы применять корреляцию Пирсона, должно выполняться несколько требований:
\begin{enumerate}
	\item Исследуемые переменные X и Y должны быть распределены нормально.
	\item Исследуемые переменные X и Y должны быть измерены в интервальной шкале или шкале отношений.
	\item Количество значений в исследуемых переменных X и Y должно быть одинаковым.
\end{enumerate}

\section{Формализация задачи}
Реализуемое ПО должно найти два признака с максимальной корреляцией. Пусть
$L^m(X_1, X_2, X_3, ... , X_m)$ -- признаковое пространство. Тогда результатом работы программы будет следующее представление \ref{form}:
\begin{equation}\label{form}
	i, j: X_i, X_j = argmax(|r_{L}|)
\end{equation}

\section{Алгоритм поиска столбцов с максимальной корреляцией}
Основной алгоритм состоит из нескольких этапов:
\begin{enumerate}
	\item Подсчёт математического ожидания для каждого признака.
	\item Нахождение корреляции для каждой пары признаков, отталкиваясь от известного математического ожидания.
	\item Поиск максимального значения коэффициента корреляции.
\end{enumerate}
Математическое ожидание для каждого признака производится через цикл по всем строкам.
Результаты заносятся в массив размером с количеством признаков.

Затем через всю матрицу значений производится проход по всем парам признаков, и 
рассчитывается корреляция, используя формулы \ref{pirson}, \ref{disperce} и \ref{covar}.

Полученное на каждой итерации значение сравнивается с максимальным на текущий момент.
Сохраняются также и индексы признаков, коэффициент корреляции Пирсона для которых постоянен.

\section{Распараллеливание основного алгоритма}
В основном алгоритме есть возможность внедрить параллельность для каждого этапа:
\begin{itemize}
	\item в этапе подсчёта среднего арифметического можно подсчитывать значение одновременно для каждого признака, так как здесь используются только значения из конкретного столбца;
	\item в этапе подсчёта корреляции можно также подсчитывать одновременно коэффициент для нескольких пар признаков.
\end{itemize}

Так как на втором этапе постоянно нужно обновлять максимум, то здесь последовательность действий для каждого потока другая:
\begin{enumerate}
	\item Поток подсчитывает максимальное значение и соответствующие индексы в своём пространстве. Все вычисления происходят внутри функции.
	\item Поток записывает получившийся результат в глобальную для потоков переменную, если его результат больше, чем значение этой переменной.
\end{enumerate}

На последнем этапе возможна гонка потоков, поэтому могут возникнуть некоторые ошибки. Чтобы их избежать, должен быть использован мьютекс,
который блокирует доступ к глобальным для потоков переменным на время записи туда нового значения. Мьютекс нужно запускать ещё до сравнения,
иначе возможны ошибки. 

\section{Вывод}
Были произведена формализация задачи, рассмотрен основной алгоритм нахождения корреляции Пирсона, а также обнаружены возможности
для распараллеливания основного алгоритма.
В качестве входных данных будет использоваться матрица, размером минимум 2x2 для корректного подсчёта корреляции Пирсона. 
На выходе программа должна вывести номера столбцов, у которых коэффициент корреляции Пирсона максимален. 
ПО должно содержать два варианта реализации алгоритма: обычный и с использованием параллельности. 